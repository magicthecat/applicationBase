@using ApplicationCore.Interfaces
@inject IExportService ExportService
@inject IJSRuntime JSRuntime

<div class="note-editor">
    <textarea @bind="NoteContent" rows="10" cols="50" placeholder="Enter your notes here..."></textarea>
    
    <div class="button-group">
        <button @onclick="ExportToCsv">Export as CSV</button>
    </div>
</div>

<style>
    .note-editor textarea {
        width: 100%;
        padding: 10px;
        box-sizing: border-box;
        font-size: 16px;
    }

    .button-group {
        margin-top: 10px;
    }
</style>

@code {
    private string NoteContent { get; set; } = string.Empty;

/*
    private async Task ExportToDocx()
    {
        var docxContent = ExportService.ToDocx(NoteContent);
        var base64DocxContent = Convert.ToBase64String(docxContent);
        await JSRuntime.InvokeVoidAsync("downloadFile", "note.docx", base64DocxContent, "application/vnd.openxmlformats-officedocument.wordprocessingml.document");
    }
*/
    private async Task ExportToCsv()
    {
        var csvContent = ExportService.ToCSV(NoteContent);
        await JSRuntime.InvokeVoidAsync("downloadFile", "note.csv", csvContent, "text/csv");
    }

}
